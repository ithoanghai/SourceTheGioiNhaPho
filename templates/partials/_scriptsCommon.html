{% load static i18n load_static %}
<!-- Scripts -->
<script type="text/javascript" src="{% load_static 'js/jquery-3.3.1.min.js' %}"></script>
<script type="text/javascript" src="{% load_static "js/vue-2.16.12.min.js" %}"></script>
<script type="text/javascript" src="{% load_static 'js/vue-resource-1.5.2.min.js' %}"></script>
<script>
    Vue.directive('click-outside', {
        bind: function (el, binding, vnode) {
            el.eventSetDrag = function () {
                el.setAttribute('data-dragging', 'yes');
            }
            el.eventClearDrag = function () {
                el.removeAttribute('data-dragging');
            }
            el.eventOnClick = function (event) {
                var dragging = el.getAttribute('data-dragging');
                // Check that the click was outside the el and its children, and wasn't a drag
                if (!(el == event.target || el.contains(event.target)) && !dragging) {
                    // call method provided in attribute value
                    vnode.context[binding.expression](event);
                }
            };
            document.addEventListener('touchstart', el.eventClearDrag);
            document.addEventListener('touchmove', el.eventSetDrag);
            document.addEventListener('click', el.eventOnClick);
            document.addEventListener('touchend', el.eventOnClick);
        }, unbind: function (el) {
            document.removeEventListener('touchstart', el.eventClearDrag);
            document.removeEventListener('touchmove', el.eventSetDrag);
            document.removeEventListener('click', el.eventOnClick);
            document.removeEventListener('touchend', el.eventOnClick);
            el.removeAttribute('data-dragging');
        },
    });
</script>

{#  <script src="{% load_static 'js/jquery-ui.min.js' %}"></script>#}

<script defer src="{% load_static 'js/feedback-modal.js' %}"></script>
<script defer src="{% load_static 'js/header-v2.min.js' %}"></script>
<script defer src="{% load_static 'js/service-sale.min.js' %}"></script>

<script data-cfasync="false" src="{% load_static 'js/email-decode.min.js' %}"></script>
<script type="deferjs" src="{% load_static 'js/jquery.flexslider.jfix-0.0.1.min.js' %}"></script>

<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>
<script defer src="https://www.google.com/recaptcha/apib091.js?render=explicit"></script>

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-60d864aab9d3c079"></script>

<!-- Messenger Plugin chat Code -->
    <div id="fb-root"></div>

    <!-- Your Plugin chat code -->
    <div id="fb-customer-chat" class="fb-customerchat">
    </div>

    <script>
      var chatbox = document.getElementById('fb-customer-chat');
      chatbox.setAttribute("page_id", "108470991299693");
      chatbox.setAttribute("attribution", "biz_inbox");
      window.fbAsyncInit = function() {
        FB.init({
          xfbml            : true,
          version          : 'v11.0'
        });
      };

      (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = 'https://connect.facebook.net/vi_VN/sdk/xfbml.customerchat.js';
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script>

   <!-- Chống sao chép website-->
{% comment %}    <script type="text/javascript">
    $(document).ready(function(){
    $('*').bind('cut copy paste contextmenu', function (e) {
        e.preventDefault();
    })});
    </script>{% endcomment %}

<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js-na1.hs-scripts.com/19875873.js"></script>
<!-- End of HubSpot Embed Code -->

<script>
    window["_au_api"] = "thue/api.html";
    window['fap_url'] = "../thegioinhaphovietnam.com.vn/p/v2.33.55/js/fap.min90ca.js?v=1617780824171";
    window['fap.server'] = '//analytics.thegioinhaphovietnam.com.vn/fap';
    window['favorite_api'] = 'mapi/index.html';
    window['googleClientId'] = '539423642927.apps.googleusercontent.com';
    window['staticUrl'] = '../thegioinhaphovietnam.com.vn/p/v2.33.55';
    window['hotline'] = '0971 841 941';

    window['isLoggedIn'] = false;
</script>

<script>
    window.hsConversationsSettings = {
        loadImmediately: false // Delay the load of the chat widget
    };
</script>

<script type="text/javascript">
    var callbackInitMap = function () {
        if (window.vinitMap) {
            window.vinitMap();
        }
        if (window.initMap) {
            initMap.call(this);
        } else {
            setTimeout(callbackInitMap, 500);
        }
    }
</script>

<script>
    (function () {
        var formQueue = [];

        function queuedForm(opt) {
            if (formQueue && !(hbspt && hbspt.forms && hbspt.forms.deps)) {
                formQueue.push(opt);
            }
        }

        var awaitTimeout = 0;
        var awaitHSForm = function () {
            awaitHSForm.called = true;
            if (formQueue && hbspt && hbspt.forms && hbspt.forms.deps) {
                formQueue.forEach(function (_opt) {
                    hbspt.forms.create(_opt);
                });
                clearTimeout(awaitTimeout);
                delete formQueue;
            } else {
                awaitTimeout = setTimeout(awaitHSForm, 500);
            }
        };
        window['hbspt'] = {
            forms: {
                create: function (opt) {
                    if (!awaitHSForm.called) {
                        awaitHSForm();
                    }
                    queuedForm(opt);
                }
            }
        };
    })();

</script>

<script>
    function createHSForm(opt) {
        function getClientId() {
            try {
                return ga.getAll()[0].get('clientId');
            } catch (e) {
                return ""
            }
        }

        var optFS = opt['onFormSubmit'];
        var defaultOpt = Object.create(opt);
        defaultOpt.onFormSubmit = function () {
            var $gaClientId = $('[name=ga_client_id]');
            if ($gaClientId[0]) {
                $gaClientId.val(getClientId());
            }
            if (typeof optFS === 'function') {
                optFS.apply(this, arguments)
            }
        };
        return hbspt.forms.create(defaultOpt);
    }

    var dialogManager = (function DialogService() {
        var fact = this;
        fact.bodyClassSpecs = "mdialog-body";
        fact.bodyLoadingClass = "mdialog-loading";
        fact.cachedBodyStyle = null;
        fact.styleOptions = {
            zindex: 99999,
            width: 300,
            minHeight: 100,
            background: "rgba(0,0,0,.5)",
            opacity: 0.5
        };
        fact.key = {
            cachedStyle: "cached-style"
        };
        var v0 = 0.05;
        var a = 0.0002;
        fact.show = function (selectorId, options, hideFn, showFn) {
            options = $.extend(true, {
                outSideClick: true
            }, options || {});
            options.maxWidth = "100%";
            var dialog, oldStyle = document.body.getAttribute("style");
            document.body.setAttribute(fact.key.cachedStyle, oldStyle);
            if (selectorId && typeof selectorId === 'string') {
                dialog = $(document.getElementById(selectorId));
            } else {
                dialog = selectorId;
            }
            dialog.css("opacity", 0);
            dialog.css("overflow-y", "auto");
            dialog.css("overflow-x", "hidden");
            dialog.addClass("opened");
            var bodyClass = (options ? options.body : "") || ".body";
            dialog.find(bodyClass).css(options);
            dialog.find(bodyClass).addClass(fact.bodyClassSpecs)
            dialog[0] ? dialog[0]["$dialogCallback"] = hideFn : null;
            dialog[0] ? dialog[0]["$dialogInitTime"] = +new Date() : null;
            if (options && options.close) {
                dialog.find(bodyClass + " " + options.close).off().click(function (e) {
                    e.preventDefault();
                    fact.hide(selectorId, hideFn);
                });
            }
            if (options && options.outSideClick) {
                dialog.off().click(function () {
                    fact.hide(selectorId, hideFn);
                });
            }
            dialog.find(bodyClass).click(function (e) {
                e.stopPropagation();
            });
            //.preventParentScroll();
            fact.animation(dialog, 0, 0, 1, function () {
                showFn ? showFn() : null;
            });
            fact.loadingEnd(dialog);
            return dialog;
        };
        fact.animation = function (dialog, opa, t, delta, callback) {
            dialog.css("opacity", opa);
            if ((delta > 0 && opa > 1) || (delta < 0 && opa < 0)) {
                if (callback) {
                    callback();
                }
                return;
            }
            setTimeout(function () {
                opa += delta * (v0 * t + 1 / 2 * a * t * t);
                fact.animation(dialog, opa, t + 1, delta, callback);
            }, 10);
        };
        fact.hide = function (selectorId, fn) {
            var dialog;
            if (!selectorId) {
                dialog = $(".mdialog.opened");
            } else if (typeof selectorId === 'string') {
                dialog = $(document.getElementById(selectorId));
            } else {
                dialog = selectorId;
            }
            fact.animation(dialog, 1, 0, -1, function () {
                dialog.removeClass("opened");
                fn ? fn(dialog) : null;
            });
        };
        fact.loadingStart = function (selectorId) {
            var dialog;
            if (!selectorId) {
                dialog = $(".mdialog.opened");
            } else if (typeof selectorId === 'string') {
                dialog = $(document.getElementById(selectorId));
            } else {
                dialog = selectorId;
            }
            dialog.find("." + fact.bodyClassSpecs).addClass(fact.bodyLoadingClass);
        };
        fact.loadingEnd = function (selectorId) {
            var dialog;
            if (!selectorId) {
                dialog = $(".mdialog.opened");
            } else if (typeof selectorId === 'string') {
                dialog = $(document.getElementById(selectorId));
            } else {
                dialog = selectorId;
            }
            dialog.find("." + fact.bodyClassSpecs + "." + fact.bodyLoadingClass).removeClass(fact.bodyLoadingClass);
        };
        $(window).keydown(function (e) {
            var openedDialog = $(".mdialog.opened");
            if (openedDialog.length && e.keyCode == 27) {
                var arr = [];
                arr.length = openedDialog.length;
                for (var i = 0; i < openedDialog.length; i++) {
                    for (var j = i; j < openedDialog.length; j++) {
                        if (openedDialog[i]["$dialogInitTime"] > openedDialog[j]["$dialogInitTime"]) {
                            arr[j] = openedDialog[i];
                            arr[i] = openedDialog[j];
                        } else {
                            arr[i] = openedDialog[i];
                            arr[j] = openedDialog[j];
                        }
                    }
                }
                var lastedOpen = arr[arr.length - 1];
                if (lastedOpen) {
                    fact.hide($(lastedOpen), lastedOpen ? lastedOpen["$dialogCallback"] : null);
                }
            }
        });
        fact.initStyles = function () {
            var css = "";
            var style = document.createElement("STYLE");
            var head = document.head || document.getElementsByTagName("head")[0];
            style.type = "text/css";
            if (style.styleSheet) {
                style.styleSheet.cssText = css;
            } else {
                style.appendChild(document.createTextNode(this.getCss()));
            }
            head.appendChild(style);
        };
        fact.getCss = function () {
            var options = fact.styleOptions;
            var css = "";
            var dialog = {};
            dialog["display"] = "none";
            dialog["position"] = "fixed";
            dialog["top"] = "0";
            dialog["height"] = "100%";
            dialog["left"] = "0";
            dialog["width"] = "100%";
            dialog["z-index"] = options.zindex;
            dialog["background"] = options.background;
            css += fact.assignStyle(".mdialog", dialog);
            css += ".mdialog.opened{display: block;}";
            var body = {};
            body["width"] = options.width + "px";
            body["min-height"] = options.minHeight + "px";
            body["background"] = "#fff";
            body["margin"] = "60px auto 140px auto";
            css += fact.assignStyle(".mdialog .body", body);
            var bodySpecs = {};
            bodySpecs["position"] = "relative"
            css += fact.assignStyle("." + fact.bodyLoadingClass, bodySpecs);
            var loadingFrame = {};
            loadingFrame["content"] = "' '";
            loadingFrame["top"] = 0;
            loadingFrame["left"] = 0;
            loadingFrame["width"] = "100%";
            loadingFrame["height"] = "100%";
            loadingFrame["position"] = "absolute";
            loadingFrame["background"] = "#fff";
            loadingFrame["opacity"] = 0.4;
            loadingFrame["z-index"] = 1;
            css += fact.assignStyle("." + fact.bodyLoadingClass + ":before", loadingFrame);
            var loading = {};
            loading["content"] = "' '";
            loading["border"] = "2px solid #303339";
            loading["border-top"] = "2px solid #fff;";
            loading["border-radius"] = "50%";
            loading["width"] = "30px";
            loading["height"] = "30px";
            loading["position"] = "absolute";
            loading["top"] = "calc(50% - 15px)";
            loading["left"] = "calc(50% - 15px)";
            loading["-webkit-animation"] = "spin 2s linear infinite";
            loading["animation"] = "spin 2s linear infinite";
            loading["z-index"] = 1;
            css += fact.assignStyle("." + fact.bodyLoadingClass + ":after", loading);
            css += "@-webkit-keyframes spin { 0% { -webkit-transform: rotate(0deg); } 100% { -webkit-transform: rotate(360deg); } } @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }";
            return css;
        };
        fact.assignStyle = function (name, cssobj) {
            var res = name + "{";
            for (var key in cssobj) {
                var val = cssobj[key];
                res += key + ":" + val + ";";
            }
            res += "}";
            return res;
        };
        fact.initStyles();
        return fact;
    })();

    if (!window['showDialog']) {
        window['showDialog'] = function (id, closeClass, bodyClass) {
            dialogManager.show("contact-now", {
                close: closeClass,
                body: bodyClass
            }, function hideFn() {
            }, function showFn(dialog) {
                $('#' + id).find("input").first().focus();
                $(bodyClass).css("max-width", "").css("width", "100%")
                    .find(".popup-contact").scrollTop(0);
            });
        }
    }
</script>

<script>
    window.RFeedback = {
        API: "https://thegioinhaphovietnam.com.vn/mapi",
        email: "",
        name: "",
        phone: "",
        ip: "10.244.0.0"
    }
</script>

<script>
    /*Footer*/
    let footerContent = $("#footer .info-container li")

    toggleFooterContent()

    footerContent.click(function (e) {
        if (window.matchMedia("(max-width: 640px)").matches) {
            // don't slideUp when click <a>
            if (e.target.tagName === 'A')
                return

            footerContent.find("ul").slideUp(300)
            footerContent.find(".zmdi").removeClass("zmdi-chevron-up").addClass("zmdi-chevron-down")
            if (!$(this).find("ul").is(":visible")) {
                $(this).find("ul").slideDown(300)
                $(this).find(".zmdi").removeClass("zmdi-chevron-down").addClass("zmdi-chevron-up")
            }
        }
    });

    $(window).resize(function () {
        toggleFooterContent()
    })

    /**
     * show/hide footer content depend on max-width
     */
    function toggleFooterContent() {
        if (window.matchMedia("(max-width: 640px)").matches) {
            footerContent.find("ul").hide()
            footerContent.find(".zmdi").removeClass("zmdi-chevron-up").addClass("zmdi-chevron-down")
        } else {
            footerContent.find("ul").show()
        }
    }

    /*Footer - END*/
</script>

<script>

    function show3DTour(src) {
        let $wrapper = $(".full-3d-tour")
        $wrapper.find('iframe').attr('src', src)
        $wrapper.show()
    }

    $(".close-3d-tour").click(function (e) {
        $(".full-3d-tour").hide();
        e.stopPropagation()
    });

    //Show demo căn hộ
    $("#demo-apart").click(function () {
        show3DTour("https://my.matterport.com/show/?m=yYDQY6WGVXi")
    })
</script>