{% extends 'base_common.html' %}

{% load static humanize i18n %}

{% block head %}
  {{ block.super }}
  <link rel="canonical" href="search"/>
  <link rel="stylesheet" href="{% static 'css/material-design-iconic-font.2.min90ca.css' %}">
  <link rel="stylesheet" href="{% static 'css/fontawsome-5.5.0.all.css' %}">
  <link rel="stylesheet" href="{% static 'css/footer.min90ca.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/popup-new.min90ca.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/flexslider.min.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/search-transition.css' %}"/>

  <style>
      [v-cloak] {
          display: none !important;
      }

      /* Ẩn các element khi vue chưa load */
      picture img {
          display: inline-block;
          vertical-align: middle;
      }

      /*hide tracking img*/
      img[src^="//analytics.thegioinhaphovietnam.com.vn/fap"], img[src^="/fap/debug/track"] {
          display: none;
      }

      ._hj_feedback_container button { /* Fix lỗi hotjar */
          text-align: center;
      }
  </style>
  <style>
      @-webkit-keyframes vueContentPlaceholdersAnimation {
          0% {
              -webkit-transform: translate3d(-30%, 0, 0);
              transform: translate3d(-30%, 0, 0);
          }
          100% {
              -webkit-transform: translate3d(100%, 0, 0);
              transform: translate3d(100%, 0, 0);
          }
      }

      @keyframes vueContentPlaceholdersAnimation {
          0% {
              -webkit-transform: translate3d(-30%, 0, 0);
              transform: translate3d(-30%, 0, 0);
          }
          100% {
              -webkit-transform: translate3d(100%, 0, 0);
              transform: translate3d(100%, 0, 0);
          }
      }

      .vue-content-placeholders-heading {
          display: -webkit-box;
          display: -ms-flexbox;
          display: flex;
      }

      [class^="vue-content-placeholders-"] + .vue-content-placeholders-heading {
          margin-top: 20px;
      }

      .vue-content-placeholders-heading__img {
          position: relative;
          overflow: hidden;
          height: 15px;
          background: #eee;
          width: 60px;
          height: 60px;
          margin-right: 15px;
      }

      .vue-content-placeholders-is-rounded .vue-content-placeholders-heading__img {
          border-radius: 6px;
      }

      .vue-content-placeholders-is-centered .vue-content-placeholders-heading__img {
          margin-left: auto;
          margin-right: auto;
      }

      .vue-content-placeholders-is-animated .vue-content-placeholders-heading__img::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100vw;
          max-width: 1000px;
          height: 100%;
          background: -webkit-gradient(linear, left top, right top, from(transparent), color-stop(15%, #e1e1e1), color-stop(30%, transparent));
          background: linear-gradient(to right, transparent 0%, #e1e1e1 15%, transparent 30%);
          -webkit-animation-duration: 1.5s;
          animation-duration: 1.5s;
          -webkit-animation-fill-mode: forwards;
          animation-fill-mode: forwards;
          -webkit-animation-iteration-count: infinite;
          animation-iteration-count: infinite;
          -webkit-animation-name: vueContentPlaceholdersAnimation;
          animation-name: vueContentPlaceholdersAnimation;
          -webkit-animation-timing-function: linear;
          animation-timing-function: linear;
      }

      .vue-content-placeholders-heading__content {
          display: -webkit-box;
          display: -ms-flexbox;
          display: flex;
          -webkit-box-flex: 1;
          -ms-flex: 1;
          flex: 1;
          -webkit-box-orient: vertical;
          -webkit-box-direction: normal;
          -ms-flex-direction: column;
          flex-direction: column;
          -webkit-box-pack: center;
          -ms-flex-pack: center;
          justify-content: center;
      }

      .vue-content-placeholders-heading__title {
          position: relative;
          overflow: hidden;
          height: 15px;
          background: #eee;
          width: 85%;
          margin-bottom: 10px;
          background: #ccc;
      }

      .vue-content-placeholders-is-rounded .vue-content-placeholders-heading__title {
          border-radius: 6px;
      }

      .vue-content-placeholders-is-centered .vue-content-placeholders-heading__title {
          margin-left: auto;
          margin-right: auto;
      }

      .vue-content-placeholders-is-animated .vue-content-placeholders-heading__title::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100vw;
          max-width: 1000px;
          height: 100%;
          background: -webkit-gradient(linear, left top, right top, from(transparent), color-stop(15%, #e1e1e1), color-stop(30%, transparent));
          background: linear-gradient(to right, transparent 0%, #e1e1e1 15%, transparent 30%);
          -webkit-animation-duration: 1.5s;
          animation-duration: 1.5s;
          -webkit-animation-fill-mode: forwards;
          animation-fill-mode: forwards;
          -webkit-animation-iteration-count: infinite;
          animation-iteration-count: infinite;
          -webkit-animation-name: vueContentPlaceholdersAnimation;
          animation-name: vueContentPlaceholdersAnimation;
          -webkit-animation-timing-function: linear;
          animation-timing-function: linear;
      }

      .vue-content-placeholders-heading__subtitle {
          position: relative;
          overflow: hidden;
          height: 15px;
          background: #eee;
          width: 90%;
      }

      .vue-content-placeholders-is-rounded .vue-content-placeholders-heading__subtitle {
          border-radius: 6px;
      }

      .vue-content-placeholders-is-centered .vue-content-placeholders-heading__subtitle {
          margin-left: auto;
          margin-right: auto;
      }

      .vue-content-placeholders-is-animated .vue-content-placeholders-heading__subtitle::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100vw;
          max-width: 1000px;
          height: 100%;
          background: -webkit-gradient(linear, left top, right top, from(transparent), color-stop(15%, #e1e1e1), color-stop(30%, transparent));
          background: linear-gradient(to right, transparent 0%, #e1e1e1 15%, transparent 30%);
          -webkit-animation-duration: 1.5s;
          animation-duration: 1.5s;
          -webkit-animation-fill-mode: forwards;
          animation-fill-mode: forwards;
          -webkit-animation-iteration-count: infinite;
          animation-iteration-count: infinite;
          -webkit-animation-name: vueContentPlaceholdersAnimation;
          animation-name: vueContentPlaceholdersAnimation;
          -webkit-animation-timing-function: linear;
          animation-timing-function: linear;
      }

      [class^="vue-content-placeholders-"] + .vue-content-placeholders-text {
          margin-top: 20px;
      }

      .vue-content-placeholders-text__line {
          position: relative;
          overflow: hidden;
          height: 15px;
          background: #eee;
          width: 100%;
          margin-bottom: 10px;
      }

      .vue-content-placeholders-is-rounded .vue-content-placeholders-text__line {
          border-radius: 6px;
      }

      .vue-content-placeholders-is-centered .vue-content-placeholders-text__line {
          margin-left: auto;
          margin-right: auto;
      }

      .vue-content-placeholders-is-animated .vue-content-placeholders-text__line::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100vw;
          max-width: 1000px;
          height: 100%;
          background: -webkit-gradient(linear, left top, right top, from(transparent), color-stop(15%, #e1e1e1), color-stop(30%, transparent));
          background: linear-gradient(to right, transparent 0%, #e1e1e1 15%, transparent 30%);
          -webkit-animation-duration: 1.5s;
          animation-duration: 1.5s;
          -webkit-animation-fill-mode: forwards;
          animation-fill-mode: forwards;
          -webkit-animation-iteration-count: infinite;
          animation-iteration-count: infinite;
          -webkit-animation-name: vueContentPlaceholdersAnimation;
          animation-name: vueContentPlaceholdersAnimation;
          -webkit-animation-timing-function: linear;
          animation-timing-function: linear;
      }

      .vue-content-placeholders-text__line:nth-child(4n + 1) {
          width: 80%;
      }

      .vue-content-placeholders-text__line:nth-child(4n + 2) {
          width: 100%;
      }

      .vue-content-placeholders-text__line:nth-child(4n + 3) {
          width: 70%;
      }

      .vue-content-placeholders-text__line:nth-child(4n + 4) {
          width: 85%;
      }

      .vue-content-placeholders-img {
          position: relative;
          overflow: hidden;
          height: 15px;
          background: #eee;
          width: 100%;
          height: 120px;
      }

      .vue-content-placeholders-is-rounded .vue-content-placeholders-img {
          border-radius: 6px;
      }

      .vue-content-placeholders-is-centered .vue-content-placeholders-img {
          margin-left: auto;
          margin-right: auto;
      }

      .vue-content-placeholders-is-animated .vue-content-placeholders-img::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100vw;
          max-width: 1000px;
          height: 100%;
          background: -webkit-gradient(linear, left top, right top, from(transparent), color-stop(15%, #e1e1e1), color-stop(30%, transparent));
          background: linear-gradient(to right, transparent 0%, #e1e1e1 15%, transparent 30%);
          -webkit-animation-duration: 1.5s;
          animation-duration: 1.5s;
          -webkit-animation-fill-mode: forwards;
          animation-fill-mode: forwards;
          -webkit-animation-iteration-count: infinite;
          animation-iteration-count: infinite;
          -webkit-animation-name: vueContentPlaceholdersAnimation;
          animation-name: vueContentPlaceholdersAnimation;
          -webkit-animation-timing-function: linear;
          animation-timing-function: linear;
      }

      [class^="vue-content-placeholders-"] + .vue-content-placeholders-img {
          margin-top: 20px;
      }
  </style>

  <link rel="stylesheet" href="{% static 'css/search-new.min90ca.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/normalize.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/ion.rangeSlider.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/ion.rangeSlider.skinFlat.css' %}"/>
  <link rel="stylesheet" href="{% static 'css/pop-up.min.css' %}"/>
  {% include 'listings/_searchXTemplate.html' %}
{% endblock %}

{% block content %}
  <!-- Search menu -->
  {% include 'partials/_menuSearch.html' %}

  <input id="elInitSearchPage" type="hidden" value="true"/>

  <div class="banner-app-tgnp" id="tgnp-banner-prompt" style="display: none">
    <div class="banner-app-content">
      <button onclick="AppPrompt.closePrompt()" class="close-banner-app">
        <i class="zmdi zmdi-close"></i>
      </button>
      <a href="javascript:void(0)" class="cover">
        <img src="{% static 'img/logo.svg' %}" alt="Thế giới Nhà Phố">
      </a>
      <div class="banner-app-info">
        <a href="javascript:void(0)">TGNP</a>
        <p>Mua bán nhà dễ dàng</p>
        <div class="rating-star">
          <i class="zmdi zmdi-star evaluated"></i>
          <i class="zmdi zmdi-star evaluated"></i>
          <i class="zmdi zmdi-star evaluated"></i>
          <i class="zmdi zmdi-star evaluated"></i>
          <i class="zmdi zmdi-star-half evaluated"></i>
        </div>
      </div>
    </div>
    <a href="javascript:void(0)" class="btn-install">Mở</a>
  </div>

  <div id="search-content" class="block-search-noresult page--search">
    <div class="search-container">
      <div class="search-result" style="z-index: auto">
        <div id="leads" class="panel" style=" z-index: auto">
          {% include "listings/_searchFilterBar.html" %}
          {% include "listings/_searchResult.html" %}
        </div>

      </div>
      <div class="search-map">
        <div class="map-container" id="search-map"></div>
      </div>
    </div>
  </div>


  <div>
    {% include "partials/_relativeDescription.html" %}
  </div>

{% endblock %}


{% block scripts %}
  {{ block.super }}

  <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
  <script src="{% static 'js/ion.rangeSlider.js' %}"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
          integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
          crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"
          integrity="sha512-WFN04846sdKMIP5LKNphMaWzU7YpMyCU245etK3g/2ARYbPK9Ub18eG+ljU96qKRCWh+quCY7yefSmlkQw1ANQ=="
          crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
  <script src="{% static 'js/jquery-ui.min90ca.js' %}"></script>

  {#        <script async defer src="{% static 'js/search-new-v2.min.js' %}"></script>#}
  {#  <script defer src="www.google.com/recaptcha/apib091.js?render=explicit"></script>#}

  <script type="text/javascript">
      var map;
      var markerData = [];
      var markers = [];

      // on:hover -> markers[index].setIcon(highlightedIcon());
      // on:hover -> markers[index].setIcon(normalIcon());

      function initialize() {
          if (window.initMap) {
              window.initMap();
          } else {
              setTimeout(initialize, 200);
          }
      }

      function normalIcon() {
          return {
              url: 'http://1.bp.blogspot.com/_GZzKwf6g1o8/S6xwK6CSghI/AAAAAAAAA98/_iA3r4Ehclk/s1600/marker-green.png'
          };
      }

      function highlightedIcon() {
          return {
              url: 'http://steeplemedia.com/images/markers/markerGreen.png'
          };
      }

      function callbackInitMap() {
          console.log('initilize map');
          initialize();
      }

  </script>
  <script async
          src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAWKbev18w2O63PfjhgpyU6DWvL6G4DCCc&libraries=drawing,places,geometry&language=vi&callback=callbackInitMap">
  </script>
  <script src="{% static 'js/search.js' %}"></script>

  <script>
      window["_au_api"] = "../thue/api";
      window['fap_url'] = "{% static 'js/fap.min90ca.js' %}";
      window['fap.server'] = '/thegioinhaphovietnam.com.vn/fap';
      window['favorite_api'] = '../mapi/index.html';
      window['staticUrl'] = '../static';
      window['hotline'] = '0964399436';
      window['isLoggedIn'] = false;
      window.hsConversationsSettings = {
          loadImmediately: false // Delay the load of the chat widget
      };
  </script>
  <script>
      {% comment %}window.fbAsyncInit = function () {
          FB.init({
              appId: '268342061639747',
              cookie: true,                     // Enable cookies to allow the server to access the session.
              xfbml: true,                     // Parse social plugins on this webpage.
              version: 'v8.0'           // Use this Graph API version for this call.
          });
      }{% endcomment %}
  </script>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>

  <script>
      function createHSForm(opt) {
          function getClientId() {
              try {
                  return ga.getAll()[0].get('clientId');
              } catch (e) {
                  return ""
              }
          }

          var optFS = opt['onFormSubmit'];
          var defaultOpt = Object.create(opt);
          defaultOpt.onFormSubmit = function () {
              var $gaClientId = $('[name=ga_client_id]');
              if ($gaClientId[0]) {
                  $gaClientId.val(getClientId());
              }
              if (typeof optFS === 'function') {
                  optFS.apply(this, arguments)
              }
          };
          return hbspt.forms.create(defaultOpt);
      }

      var dialogManager = (function DialogService() {
          var fact = this;
          fact.bodyClassSpecs = "mdialog-body";
          fact.bodyLoadingClass = "mdialog-loading";
          fact.cachedBodyStyle = null;
          fact.default = {
              zindex: 99999,
              width: 300,
              minHeight: 100,
              background: "rgba(0,0,0,.5)",
              opacity: 0.5
          };
          fact.key = {
              cachedStyle: "cached-style"
          };
          var v0 = 0.05;
          var a = 0.0002;
          fact.show = function (selectorId, options, hideFn, showFn) {
              options = $.extend(true, {
                  outSideClick: true
              }, options || {});
              options.maxWidth = "100%";
              var dialog, oldStyle = document.body.getAttribute("style");
              document.body.setAttribute(fact.key.cachedStyle, oldStyle);
              if (selectorId && typeof selectorId === 'string') {
                  dialog = $(document.getElementById(selectorId));
              } else {
                  dialog = selectorId;
              }
              dialog.css("opacity", 0);
              dialog.css("overflow-y", "auto");
              dialog.css("overflow-x", "hidden");
              dialog.addClass("opened");
              var bodyClass = (options ? options.body : "") || ".body";
              dialog.find(bodyClass).css(options);
              dialog.find(bodyClass).addClass(fact.bodyClassSpecs)
              dialog[0] ? dialog[0]["$dialogCallback"] = hideFn : null;
              dialog[0] ? dialog[0]["$dialogInitTime"] = +new Date() : null;
              if (options && options.close) {
                  dialog.find(bodyClass + " " + options.close).off().click(function (e) {
                      e.preventDefault();
                      fact.hide(selectorId, hideFn);
                  });
              }
              if (options && options.outSideClick) {
                  dialog.off().click(function () {
                      fact.hide(selectorId, hideFn);
                  });
              }
              dialog.find(bodyClass).click(function (e) {
                  e.stopPropagation();
              });
              //.preventParentScroll();
              fact.animation(dialog, 0, 0, 1, function () {
                  showFn ? showFn() : null;
              });
              fact.loadingEnd(dialog);
              return dialog;
          };
          fact.animation = function (dialog, opa, t, delta, callback) {
              dialog.css("opacity", opa);
              if ((delta > 0 && opa > 1) || (delta < 0 && opa < 0)) {
                  if (callback) {
                      callback();
                  }
                  return;
              }
              setTimeout(function () {
                  opa += delta * (v0 * t + 1 / 2 * a * t * t);
                  fact.animation(dialog, opa, t + 1, delta, callback);
              }, 10);
          };
          fact.hide = function (selectorId, fn) {
              var dialog;
              if (!selectorId) {
                  dialog = $(".mdialog.opened");
              } else if (typeof selectorId === 'string') {
                  dialog = $(document.getElementById(selectorId));
              } else {
                  dialog = selectorId;
              }
              fact.animation(dialog, 1, 0, -1, function () {
                  dialog.removeClass("opened");
                  fn ? fn(dialog) : null;
              });
          };
          fact.loadingStart = function (selectorId) {
              var dialog;
              if (!selectorId) {
                  dialog = $(".mdialog.opened");
              } else if (typeof selectorId === 'string') {
                  dialog = $(document.getElementById(selectorId));
              } else {
                  dialog = selectorId;
              }
              dialog.find("." + fact.bodyClassSpecs).addClass(fact.bodyLoadingClass);
          };
          fact.loadingEnd = function (selectorId) {
              var dialog;
              if (!selectorId) {
                  dialog = $(".mdialog.opened");
              } else if (typeof selectorId === 'string') {
                  dialog = $(document.getElementById(selectorId));
              } else {
                  dialog = selectorId;
              }
              dialog.find("." + fact.bodyClassSpecs + "." + fact.bodyLoadingClass).removeClass(fact.bodyLoadingClass);
          };
          $(window).keydown(function (e) {
              var openedDialog = $(".mdialog.opened");
              if (openedDialog.length && e.keyCode == 27) {
                  var arr = [];
                  arr.length = openedDialog.length;
                  for (var i = 0; i < openedDialog.length; i++) {
                      for (var j = i; j < openedDialog.length; j++) {
                          if (openedDialog[i]["$dialogInitTime"] > openedDialog[j]["$dialogInitTime"]) {
                              arr[j] = openedDialog[i];
                              arr[i] = openedDialog[j];
                          } else {
                              arr[i] = openedDialog[i];
                              arr[j] = openedDialog[j];
                          }
                      }
                  }
                  var lastedOpen = arr[arr.length - 1];
                  if (lastedOpen) {
                      fact.hide($(lastedOpen), lastedOpen ? lastedOpen["$dialogCallback"] : null);
                  }
              }
          });
          fact.initStyles = function () {
              var css = "";
              var style = document.createElement("STYLE");
              var head = document.head || document.getElementsByTagName("head")[0];
              style.type = "text/css";
              if (style.styleSheet) {
                  style.styleSheet.cssText = css;
              } else {
                  style.appendChild(document.createTextNode(this.getCss()));
              }
              head.appendChild(style);
          };
          fact.getCss = function () {
              var options = fact.default;
              var css = "";
              var dialog = {};
              dialog["display"] = "none";
              dialog["position"] = "fixed";
              dialog["top"] = "0";
              dialog["height"] = "100%";
              dialog["left"] = "0";
              dialog["width"] = "100%";
              dialog["z-index"] = options.zindex;
              dialog["background"] = options.background;
              css += fact.assignStyle(".mdialog", dialog);
              css += ".mdialog.opened{display: block;}";
              var body = {};
              body["width"] = options.width + "px";
              body["min-height"] = options.minHeight + "px";
              body["background"] = "#fff";
              body["margin"] = "60px auto 140px auto";
              css += fact.assignStyle(".mdialog .body", body);
              var bodySpecs = {};
              bodySpecs["position"] = "relative"
              css += fact.assignStyle("." + fact.bodyLoadingClass, bodySpecs);
              var loadingFrame = {};
              loadingFrame["content"] = "' '";
              loadingFrame["top"] = 0;
              loadingFrame["left"] = 0;
              loadingFrame["width"] = "100%";
              loadingFrame["height"] = "100%";
              loadingFrame["position"] = "absolute";
              loadingFrame["background"] = "#fff";
              loadingFrame["opacity"] = 0.4;
              loadingFrame["z-index"] = 1;
              css += fact.assignStyle("." + fact.bodyLoadingClass + ":before", loadingFrame);
              var loading = {};
              loading["content"] = "' '";
              loading["border"] = "2px solid #303339";
              loading["border-top"] = "2px solid #fff;";
              loading["border-radius"] = "50%";
              loading["width"] = "30px";
              loading["height"] = "30px";
              loading["position"] = "absolute";
              loading["top"] = "calc(50% - 15px)";
              loading["left"] = "calc(50% - 15px)";
              loading["-webkit-animation"] = "spin 2s linear infinite";
              loading["animation"] = "spin 2s linear infinite";
              loading["z-index"] = 1;
              css += fact.assignStyle("." + fact.bodyLoadingClass + ":after", loading);
              css += "@-webkit-keyframes spin { 0% { -webkit-transform: rotate(0deg); } 100% { -webkit-transform: rotate(360deg); } } @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }";
              return css;
          };
          fact.assignStyle = function (name, cssobj) {
              var res = name + "{";
              for (var key in cssobj) {
                  var val = cssobj[key];
                  res += key + ":" + val + ";";
              }
              res += "}";
              return res;
          };
          fact.initStyles();
          return fact;
      })();

      if (!window['showDialog']) {
          window['showDialog'] = function (id, closeClass, bodyClass) {
              dialogManager.show("contact-now", {
                  close: closeClass,
                  body: bodyClass
              }, function hideFn() {
              }, function showFn(dialog) {
                  $('#' + id).find("input").first().focus();
                  $(bodyClass).css("max-width", "").css("width", "100%")
                      .find(".popup-contact").scrollTop(0);
              });
          }
      }
  </script>
  <script async defer src="{% static 'js/login-popup-app.min90ca.js' %}"></script>
  <script async defer src="{% static 'js/header-v2.min90ca.js' %}"></script>

{% endblock %}



